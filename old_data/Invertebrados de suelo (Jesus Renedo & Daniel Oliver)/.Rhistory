# Calcular las medias predichas por nivel de tratamiento
media_predicha <- aggregate(pred_biomass ~ tratamiento, data = pred_df, FUN = mean)
# Graficar las medias predichas
ggplot(media_predicha, aes(x = tratamiento, y = pred_biomass)) +
geom_point(size = 3) +                         # Puntos de las medias
geom_line(group = 1, color = "blue") +         # Línea de conexión
labs(title = "Medias predichas de Biomasa por Tratamiento",
x = "Tratamiento", y = "Biomasa Predicha") +
theme_minimal()
# Ajustar un modelo ANOVA para ver las diferencias entre tratamientos
anova_model <- aov(pred_biomass ~ tratamiento, data = pred_df)
# Realizar un test de Tukey para comparaciones post-hoc
tukey_resultados <- TukeyHSD(anova_model)
# Ver los resultados del test de Tukey
summary(tukey_resultados)
# Graficar el test de Tukey
plot(tukey_resultados)
library(readxl)
# Cargar la tercera hoja del archivo Excel
pitfalls_data_general_incremento <- read_excel("pitfalls_data_general_incremento.xlsx",
sheet = 5)
names(pitfalls_data_general_incremento)
pitfalls_data_general_incremento
pitfalls_data_general_incremento$date
#Cambio fecha tipo
pitfalls_data_general_incremento$date <- as.Date(
pitfalls_data_general_incremento$date,
origin = "1899-12-30"
)
pitfalls_data_general_incremento
View(pitfalls_data_general_incremento)
# Algunos gráficos de las medidas objetivo
hist(pitfalls_data_general_incremento$total_area_mm2, breaks = 100)
hist(pitfalls_data_general_incremento$weight_model, breaks = 100)
# Crear un gráfico de dispersión
plot(
pitfalls_data_general_incremento$total_area_mm2,
pitfalls_data_general_incremento$weight_model,
main = "Gráfico de correlación entre total_area_mm2 y weight_model",
xlab = "Área total (mm²)",
ylab = "Peso modelado",
pch = 16,        # Forma de los puntos
col = "blue",    # Color de los puntos
cex = 0.7        # Tamaño de los puntos
)
# Agregar una línea de tendencia
abline(
lm(pitfalls_data_general_incremento$weight_model ~ pitfalls_data_general_incremento$total_area_mm2),
col = "red",
lwd = 2
)
library (dplyr)
# Generar un resumen a nivel de pitfall con la suma de los pesos
pitfall_summary <- pitfalls_data_general_incremento %>%
group_by(sample, site_code) %>%  # Agrupar por "sample" y mantener "site_code"
summarise(
num_insects = n(),  # Contar el número de insectos (filas)
total_biomass = sum(weight_model, na.rm = TRUE),  # Sumar el peso total (biomasa)
sd_weight = sd(weight_model, na.rm = TRUE)  # Calcular la desviación estándar del peso
) %>%
mutate(tratamiento = case_when(
site_code == "MC" ~ substr(sample, 4, 5),  # Extraer 4ª y 5ª letra si el site_code es "MC"
site_code == "QM" ~ substr(sample, 4, 4),  # Extraer solo la 4ª letra si el site_code es "QM"
TRUE ~ NA_character_  # Asignar NA en los demás casos
))
# Ver los primeros registros para verificar el resultado
head(pitfall_summary)
library (dplyr)
# Generar un resumen a nivel de pitfall con la suma de los pesos
pitfall_summary <- pitfalls_data_general_incremento %>%
group_by(sample, site_code) %>%  # Agrupar por "sample" y mantener "site_code"
summarise(
num_insects = n(),  # Contar el número de insectos (filas)
total_biomass = sum(weight_model, na.rm = TRUE),  # Sumar el peso total (biomasa)
sd_weight = sd(weight_model, na.rm = TRUE),  # Calcular la desviación estándar del peso
earliest_date = min(date, na.rm = TRUE)  # Fecha más temprana
) %>%
mutate(tratamiento = case_when(
site_code == "MC" ~ substr(sample, 4, 5),  # Extraer 4ª y 5ª letra si el site_code es "MC"
site_code == "QM" ~ substr(sample, 4, 4),  # Extraer solo la 4ª letra si el site_code es "QM"
TRUE ~ NA_character_  # Asignar NA en los demás casos
))
# Ver los primeros registros para verificar el resultado
head(pitfall_summary)
pitfall_summary
library(readxl)
# Cargar la tercera hoja del archivo Excel
pitfalls_data_general_incremento <- read_excel("pitfalls_data_general_incremento.xlsx",
sheet = 5)
names(pitfalls_data_general_incremento)
#Cambio fecha tipo
pitfalls_data_general_incremento$date <- as.Date(
pitfalls_data_general_incremento$date,
origin = "1899-12-30"
)
pitfalls_data_general_incremento <- read_excel("pitfalls_data_general_incremento.xlsx",
sheet = 5)
names(pitfalls_data_general_incremento)
pitfalls_data_general_incremento$date
unique(pitfalls_data_general_incremento$date)
library(readxl)
# Cargar la tercera hoja del archivo Excel
pitfalls_data_general_incremento <- read_excel("pitfalls_data_general_incremento.xlsx",
sheet = 5)
names(pitfalls_data_general_incremento)
#Cambio fecha tipo
pitfalls_data_general_incremento$date <- as.Date(
pitfalls_data_general_incremento$date,
origin = "1899-12-30"
)
# Algunos gráficos de las medidas objetivo
hist(pitfalls_data_general_incremento$total_area_mm2, breaks = 100)
hist(pitfalls_data_general_incremento$weight_model, breaks = 100)
# Crear un gráfico de dispersión
plot(
pitfalls_data_general_incremento$total_area_mm2,
pitfalls_data_general_incremento$weight_model,
main = "Gráfico de correlación entre total_area_mm2 y weight_model",
xlab = "Área total (mm²)",
ylab = "Peso modelado",
pch = 16,        # Forma de los puntos
col = "blue",    # Color de los puntos
cex = 0.7        # Tamaño de los puntos
)
# Agregar una línea de tendencia
abline(
lm(pitfalls_data_general_incremento$weight_model ~ pitfalls_data_general_incremento$total_area_mm2),
col = "red",
lwd = 2
)
library (dplyr)
# Generar un resumen a nivel de pitfall con la suma de los pesos
pitfall_summary <- pitfalls_data_general_incremento %>%
group_by(sample, site_code) %>%  # Agrupar por "sample" y mantener "site_code"
summarise(
num_insects = n(),  # Contar el número de insectos (filas)
total_biomass = sum(weight_model, na.rm = TRUE),  # Sumar el peso total (biomasa)
sd_weight = sd(weight_model, na.rm = TRUE),  # Calcular la desviación estándar del peso
earliest_date = min(date, na.rm = TRUE)  # Fecha más temprana
) %>%
mutate(tratamiento = case_when(
site_code == "MC" ~ substr(sample, 4, 5),  # Extraer 4ª y 5ª letra si el site_code es "MC"
site_code == "QM" ~ substr(sample, 4, 4),  # Extraer solo la 4ª letra si el site_code es "QM"
TRUE ~ NA_character_  # Asignar NA en los demás casos
))
# Ver los primeros registros para verificar el resultado
head(pitfall_summary)
unique(pitfall_summary$earliest_date)
library(readxl)
# Cargar la tercera hoja del archivo Excel
pitfalls_data_general_incremento <- read_excel("pitfalls_data_general_incremento.xlsx",
sheet = 5)
names(pitfalls_data_general_incremento)
#Cambio fecha tipo
pitfalls_data_general_incremento$date <- as.Date(
pitfalls_data_general_incremento$date,
origin = "1899-12-30"
)
# Algunos gráficos de las medidas objetivo
hist(pitfalls_data_general_incremento$total_area_mm2, breaks = 100)
hist(pitfalls_data_general_incremento$weight_model, breaks = 100)
# Crear un gráfico de dispersión
plot(
pitfalls_data_general_incremento$total_area_mm2,
pitfalls_data_general_incremento$weight_model,
main = "Gráfico de correlación entre total_area_mm2 y weight_model",
xlab = "Área total (mm²)",
ylab = "Peso modelado",
pch = 16,        # Forma de los puntos
col = "blue",    # Color de los puntos
cex = 0.7        # Tamaño de los puntos
)
# Agregar una línea de tendencia
abline(
lm(pitfalls_data_general_incremento$weight_model ~ pitfalls_data_general_incremento$total_area_mm2),
col = "red",
lwd = 2
)
library (dplyr)
# Resumir datos y agregar la columna "Year"
pitfall_summary <- pitfalls_data_general_incremento %>%
group_by(sample, site_code) %>%
summarise(
num_insects = n(),
total_biomass = sum(weight_model, na.rm = TRUE),
sd_weight = sd(weight_model, na.rm = TRUE),
earliest_date = min(date, na.rm = TRUE)  # Fecha más temprana
) %>%
mutate(
Year = format(earliest_date, "%Y")  # Extraer el año de earliest_date
) %>%
mutate(tratamiento = case_when(
site_code == "MC" ~ substr(sample, 4, 5),
site_code == "QM" ~ substr(sample, 4, 4),
TRUE ~ NA_character_
))
# Verificar el resultado
head(pitfall_summary)
library (dplyr)
# Resumir datos y agregar la columna "Year"
pitfall_summary <- pitfalls_data_general_incremento %>%
group_by(sample, site_code) %>%
summarise(
num_insects = n(),
total_biomass = sum(weight_model, na.rm = TRUE),
sd_weight = sd(weight_model, na.rm = TRUE),
earliest_date = min(date, na.rm = TRUE)  # Fecha más temprana
) %>%
mutate(
year = format(earliest_date, "%Y")  # Extraer el año de earliest_date
) %>%
mutate(tratamiento = case_when(
site_code == "MC" ~ substr(sample, 4, 5),
site_code == "QM" ~ substr(sample, 4, 4),
TRUE ~ NA_character_
))
# Verificar el resultado
head(pitfall_summary)
library(ggplot2)
# Boxplot para la biomasa total en QM
ggplot(pitfall_summary %>% filter(site_code == "QM"), aes(x = tratamiento, y = total_biomass)) +
geom_boxplot() +
labs(
title = "Distribución de la biomasa total por tratamiento en QM",
x = "Tratamiento",
y = "Biomasa total"
) +
theme_minimal()
# Boxplot para la biomasa total en MC
ggplot(pitfall_summary %>% filter(site_code == "MC"), aes(x = tratamiento, y = total_biomass)) +
geom_boxplot() +
labs(
title = "Distribución de la biomasa total por tratamiento en MC",
x = "Tratamiento",
y = "Biomasa total"
) +
theme_minimal()
library(ggplot2)
# Boxplot para la biomasa total en QM, separado por año
ggplot(pitfall_summary %>% filter(site_code == "QM"), aes(x = tratamiento, y = total_biomass)) +
geom_boxplot() +
facet_wrap(~ Year) +  # Crear un panel por año
labs(
title = "Distribución de la biomasa total por tratamiento en QM (por año)",
x = "Tratamiento",
y = "Biomasa total"
) +
theme_minimal()
library(ggplot2)
# Boxplot para la biomasa total en QM, separado por año
ggplot(pitfall_summary %>% filter(site_code == "QM"), aes(x = tratamiento, y = total_biomass)) +
geom_boxplot() +
facet_wrap(~ year) +  # Crear un panel por año
labs(
title = "Distribución de la biomasa total por tratamiento en QM (por año)",
x = "Tratamiento",
y = "Biomasa total"
) +
theme_minimal()
# Boxplot para la biomasa total en MC, separado por año
ggplot(pitfall_summary %>% filter(site_code == "MC"), aes(x = tratamiento, y = total_biomass)) +
geom_boxplot() +
facet_wrap(~ year) +  # Crear un panel por año
labs(
title = "Distribución de la biomasa total por tratamiento en MC (por año)",
x = "Tratamiento",
y = "Biomasa total"
) +
theme_minimal()
# Filtrar los datos para el site_code "QM"
qm_data <- pitfall_summary %>%
filter(site_code == "QM")
# Filtrar los datos para el site_code "MC"
mc_data <- pitfall_summary %>%
filter(site_code == "MC")
hist(qm_data$total_biomass)
hist(mc_data$total_biomass)
qm_data
# Filtrar los datos para el site_code "QM"
qm_data <- pitfall_summary %>%
filter(site_code == "QM")
# Filtrar los datos para el site_code "MC"
mc_data <- pitfall_summary %>%
filter(site_code == "MC")
# Histograma para QM
ggplot(qm_data, aes(x = total_biomass)) +
geom_histogram(binwidth = 5, fill = "steelblue", color = "black", alpha = 0.7) +
labs(
title = "Distribución de la biomasa total en QM",
x = "Biomasa total",
y = "Frecuencia"
) +
theme_minimal()
# Histograma para MC
ggplot(mc_data, aes(x = total_biomass)) +
geom_histogram(binwidth = 5, fill = "darkorange", color = "black", alpha = 0.7) +
labs(
title = "Distribución de la biomasa total en MC",
x = "Biomasa total",
y = "Frecuencia"
) +
theme_minimal()
# Histograma para QM
ggplot(qm_data, aes(x = total_biomass)) +
geom_histogram(binwidth = 0.1, fill = "steelblue", color = "black", alpha = 0.7) +
labs(
title = "Distribución de la biomasa total en QM",
x = "Biomasa total",
y = "Frecuencia"
) +
theme_minimal()
# Histograma para MC
ggplot(mc_data, aes(x = total_biomass)) +
geom_histogram(binwidth = 0.1, fill = "darkorange", color = "black", alpha = 0.7) +
labs(
title = "Distribución de la biomasa total en MC",
x = "Biomasa total",
y = "Frecuencia"
) +
theme_minimal()
# Histograma para MC
ggplot(mc_data, aes(x = total_biomass)) +
geom_histogram(binwidth = 0.05, fill = "darkorange", color = "black", alpha = 0.7) +
labs(
title = "Distribución de la biomasa total en MC",
x = "Biomasa total",
y = "Frecuencia"
) +
theme_minimal()
# Histograma para QM
ggplot(qm_data, aes(x = total_biomass)) +
geom_histogram(binwidth = 0.05, fill = "steelblue", color = "black", alpha = 0.7) +
labs(
title = "Distribución de la biomasa total en QM",
x = "Biomasa total",
y = "Frecuencia"
) +
theme_minimal()
modelo_biomasa <- glm(total_biomass ~ tratamiento * factor(year),
data = qm_data,
family = Gamma(link = "log"))
# Resumen del modelo
summary(modelo_biomasa)
modelo_biomasa <- glm(total_biomass ~ tratamiento + factor(year),
data = qm_data,
family = Gamma(link = "log"))
# Resumen del modelo
summary(modelo_biomasa)
modelo_biomasa <- glm(total_biomass ~ tratamiento + factor(year),
data = qm_data,
family = Gamma(link = "log"))
# Resumen del modelo
summary(modelo_biomasa)
library(DHARMa)
# Generar los residuos simulados
residuos <- simulateResiduals(modelo_biomasa)
plot(residuos)
library(DHARMa)
# Generar los residuos simulados
residuos <- simulateResiduals(modelo_biomasa)
plot(residuos)
# Obtener las predicciones para cada nivel de tratamiento
predicciones <- predict(modelo_biomasa, type = "response", se.fit = TRUE)
# Crear un data frame con las predicciones y los tratamientos
pred_df <- data.frame(
tratamiento = qm_data$tratamiento,
pred_biomass = predicciones$fit,
se_biomass = predicciones$se.fit
)
# Calcular las medias predichas por nivel de tratamiento
media_predicha <- aggregate(pred_biomass ~ tratamiento, data = pred_df, FUN = mean)
# Graficar las medias predichas
ggplot(media_predicha, aes(x = tratamiento, y = pred_biomass)) +
geom_point(size = 3) +                         # Puntos de las medias
geom_line(group = 1, color = "blue") +         # Línea de conexión
labs(title = "Medias predichas de Biomasa por Tratamiento",
x = "Tratamiento", y = "Biomasa Predicha") +
theme_minimal()
# Resumen del modelo
summary(modelo_biomasa)
install.packages("emmeans")
library(emmeans)
# Calcular las medias marginales para el tratamiento
emmeans_result <- emmeans(modelo_biomasa, ~ tratamiento)
# Mostrar las medias ajustadas
summary(emmeans_result)
ggplot(as.data.frame(emmeans_result), aes(x = tratamiento, y = emmean)) +
geom_point(size = 4, color = "blue") +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2) +  # Intervalos de confianza
labs(
title = "Medias ajustadas de biomasa total por tratamiento",
x = "Tratamiento",
y = "Biomasa ajustada"
) +
theme_minimal()
#  Calcular las emmeans para el tratamiento
emmeans_model <- emmeans(modelo_biomasa, ~ tratamiento, type = "response")
# Ver los resultados
summary(emmeans_model)
# Graficar las emmeans para el tratamiento
plot(emmeans_model)
pairs(emmeans_model)
# Graficar las emmeans para el tratamiento
plot(emmeans_model)
modelo_biomasa <- glm(total_biomass ~ tratamiento * factor(year),
data = qm_data,
family = Gamma(link = "log"))
# Resumen del modelo
summary(modelo_biomasa)
modelo_biomasa <- glm(total_biomass ~ tratamiento + factor (year) + tratamiento * factor(year),
data = qm_data,
family = Gamma(link = "log"))
# Resumen del modelo
summary(modelo_biomasa)
modelo_biomasa <- glm(total_biomass ~ tratamiento + factor (year),
data = qm_data,
family = Gamma(link = "log"))
# Resumen del modelo
summary(modelo_biomasa)
# Resumen del modelo
summary(modelo_biomasa)
# Model testing
residuos <- simulateResiduals(modelo_biomasa)
plot(residuos)
#  Calcular las emmeans para el tratamiento
emmeans_model <- emmeans(modelo_biomasa, ~ tratamiento, type = "response")
# Ver los resultados
summary(emmeans_model)
# Graficar las emmeans para el tratamiento
plot(emmeans_model)
pairs(emmeans_model)
# Filtrar los datos para MC y los tratamientos de interés
mc_data <- pitfall_summary %>% filter(site_code == "MC")
mc_data
modelo_biomasa <- glm(total_biomass ~ tratamiento + factor (year),
data = mc_data,
family = Gamma(link = "log"))
# Resumen del modelo
summary(modelo_biomasa)
# Model testing
residuos <- simulateResiduals(modelo_biomasa)
plot(residuos)
#  Calcular las emmeans para el tratamiento
emmeans_model <- emmeans(modelo_biomasa, ~ tratamiento, type = "response")
# Ver los resultados
summary(emmeans_model)
# Graficar las emmeans para el tratamiento
plot(emmeans_model)
pairs(emmeans_model)
datos <- read.table("redes22/nw_qc1_corr.txt", header = TRUE, row.names = 1, sep = "\t")
datos <- read.table("redes21/nw_qc1_corr.txt", header = TRUE, row.names = 1, sep = "\t")
datos <- read.table("redes21/nw_qc1_corr.txt", header = TRUE, row.names = 1, sep = "\t")
# Verificar la estructura del archivo
head(datos)  # Muestra las primeras filas
str(datos)   # Muestra la estructura del objeto
# Convertir a matriz de adyacencia
matriz_adyacencia <- as.matrix(datos)
# Verificar la matriz
print(matriz_adyacencia)
library(tools)
```{r}
# Crear una lista para almacenar las matrices
matrices <- list()
# Recorrer cada carpeta
for (carpeta in carpetas) {
# Obtener la lista de archivos .txt en la carpeta
archivos <- list.files(path = carpeta, pattern = "\\.txt$", full.names = TRUE)
# Recorrer cada archivo
for (archivo in archivos) {
# Leer el archivo
datos <- read.table(archivo, header = TRUE, row.names = 1, sep = "\t")
# Convertir a matriz de adyacencia
matriz_adyacencia <- as.matrix(datos)
# Obtener el nombre del archivo sin la extensión
nombre_archivo <- file_path_sans_ext(basename(archivo))
# Asignar la matriz a una variable con el nombre del archivo
assign(nombre_archivo, matriz_adyacencia)
# Guardar la matriz en la lista
matrices[[nombre_archivo]] <- matriz_adyacencia
}
}
# Definir las rutas de las carpetas
carpetas <- c("redes21", "redes22")
# Crear una lista para almacenar las matrices
matrices <- list()
# Recorrer cada carpeta
for (carpeta in carpetas) {
# Obtener la lista de archivos .txt en la carpeta
archivos <- list.files(path = carpeta, pattern = "\\.txt$", full.names = TRUE)
# Recorrer cada archivo
for (archivo in archivos) {
# Leer el archivo
datos <- read.table(archivo, header = TRUE, row.names = 1, sep = "\t")
# Convertir a matriz de adyacencia
matriz_adyacencia <- as.matrix(datos)
# Obtener el nombre del archivo sin la extensión
nombre_archivo <- file_path_sans_ext(basename(archivo))
# Asignar la matriz a una variable con el nombre del archivo
assign(nombre_archivo, matriz_adyacencia)
# Guardar la matriz en la lista
matrices[[nombre_archivo]] <- matriz_adyacencia
}
}
# Verificar las matrices cargadas
print(ls())  # Muestra las variables creadas
print(names(matrices))  # Muestra los nombres de las matrices en la lista
# Verificar las matrices cargadas
print(ls())  # Muestra las variables creadas
View(datos)
View(datos)
View(datos)
matrices$Q22A3
